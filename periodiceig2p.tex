\documentclass[thesis.tex]{subfiles}

\begin{document}

\iffulldocument\else
	\chapter{KdV5}
\fi

\section{Proof of stability theorems for periodic 2-pulse}

\subsection{Proof of Corollary \ref{2blockmatrix}}

In this section, we will compute the determinant of the block matrix $S(\lambda)$ from \cref{blockmatrixtheorem} for the periodic 2-pulse. The computation is tedious, but it can be done with the aid of Mathematica. Choose a positive integer $N$, and let $\delta(r, N)$ be as in \cref{blockmatrixtheorem}. In particular, we note that $\delta(r,N) \leq N/|\log r|$. 

To compute the determinant, we write the block matrix $S(\lambda)$ as $S(\lambda) = S_1(\lambda) + S_2(\lambda)$, where the leading order terms are given by
\begin{align*}
S_1&(\lambda) = \\
&\begin{pmatrix}
\begin{pmatrix}
e^{-\nu(\lambda)X_1} & -e^{\nu(\lambda)X_0} \\
-e^{\nu(\lambda)X_1} & e^{-\nu(\lambda)X_0} 
\end{pmatrix} &
2 \lambda \begin{pmatrix}
-e^{-\nu(\lambda)X_1} q(X_1) + e^{\nu(\lambda)X_0} q(X_1) & e^{-\nu(\lambda)X_1} q(X_1) - e^{\nu(\lambda)X_0} q(X_1) \\ e^{-\nu(\lambda)X_0} q(X_1) - e^{\nu(\lambda)X_1} q(X_1) & -e^{-\nu(\lambda)X_0} q(X_1) + e^{\nu(\lambda)X_1} q(X_1)
\end{pmatrix} \\
-M^c \lambda
\begin{pmatrix}
e^{-\nu(\lambda)X_1} & e^{\nu(\lambda)X_0} \\
e^{\nu(\lambda)X_1} & e^{-\nu(\lambda)X_0} 
\end{pmatrix} &
\begin{pmatrix}
-a - \lambda^2 M & a \\
a & -a - \lambda^2 M
\end{pmatrix}
\end{pmatrix}
\end{align*}
where
\[
a = \langle \Psi(X_0), Q'(-X_0) \rangle + \langle \Psi(X_1), Q'(-X_1) \rangle
\]
and the remainder terms are in $S_2(\lambda)$, which is the block matrix 
\[
S_2(\lambda) = \begin{pmatrix}
C_1 & D_1 \\ C_2 & D_2
\end{pmatrix}
\]

We use Mathematica to evaluate the determinant. To do ths, we carefully track each remainder term in each remainder matrix in $S_2(\lambda)$ and use Lemma \ref{lemma:expnubound} to bound terms of the form $e^{\pm \nu(\lambda)X_j}$. Doing this and simplifying, we have
\begin{equation}\label{2detB1}
\begin{aligned}
\det S(&\lambda) = \sinh(\nu(\lambda)X)\left(-2 \lambda^2 M (2a + \lambda^2 M) +  \mathcal{O}( (r^{1/2} + |\lambda|)^5 \right) \\
&-\lambda^4 q(X_0) M M^c \left( \sinh(\nu(\lambda)(2 X_0 + X_1)) - 3 \sinh(\nu(\lambda)X_1)  \right) \\
&-\lambda^4 q(X_1) M M^c \left( \sinh(\nu(\lambda)(2 X_1 + X_0)) - 3 \sinh(\nu(\lambda)X_0)  \right) \\
&+ \mathcal{O}( (r^{1/2} + |\lambda|)^6) 
\end{aligned}
\end{equation}
Using standard hyperbolic trigonometric identities, we can show that 
\begin{align*}
\sinh(2 x + y) - 3 \sinh(y) &= 4 \cosh(x + y)\sinh(x) 
-2 \sinh(x+y)\cosh(x) 
\end{align*}
Using this with the second line of \cref{2detB1}, 
\begin{align*}
\lambda^4 &q(X_0) \left( \sinh(\nu(\lambda)(2 X_0 + X_1)) - 3 \sinh(\nu(\lambda)X_1)  \right) \\
&= 4 \lambda^4 q(X_0) \cosh(\nu(\lambda)X)\sinh(\nu(\lambda)X_0) - 3 \lambda^4 q(X_0) \sinh(\nu(\lambda)X)\cosh(\nu(\lambda)X_0) \\
&= 4 \lambda^4 q(X_0) \cosh(\nu(\lambda)X)\sinh(\nu(\lambda)X_0) + \sinh(\nu(\lambda)X)(\mathcal{O}(r^{1/2}|\lambda|^4))
\end{align*}
since $|\cosh(\nu(\lambda)X_0)|\leq C$ by Lemma \ref{lemma:expnubound}. Doing the same thing for the third line of \cref{2detB1}, substituting the results into \cref{2detB1}, and simplifying, we have
\begin{equation}\label{2pdetSlambda}
\begin{aligned}
\det S(&\lambda) = \left(-2 \lambda^2 M (2a + \lambda^2 M) + R_1  \right) \sinh(\nu(\lambda)X) \\
&-4 M M^c \lambda^4 ( q(X_0) \sinh(\nu(\lambda)X_0) + q(X_1) \sinh(\nu(\lambda)X_1) ) \cosh(\nu(\lambda)X)  + R_2
\end{aligned}
\end{equation}
where the remainder terms have bounds
\begin{align*}
|R_1| \leq C(r^{1/2} + |\lambda|)^5 \\
|R_2| \leq C(r^{1/2} + |\lambda|)^6
\end{align*}

\subsection{Change of variables}

We can now solve equation \cref{2pdetSlambda} to find the eigenvalues $\lambda$. However, this equation involves both $\lambda$ and $\nu(\lambda)$, which is annoying. We will simplify the problem by making a change of variables. Since $\nu'(0) = 1/c$ and $\nu(0) = 0$, $\nu(\lambda)$ is invertible near 0. Let $\lambda = \nu^{-1}(\mu)$. Expanding in Taylor series about $\mu = 0$, we have
\begin{equation}\label{2plambdamu}
\lambda = \nu^{-1}(\mu) = c \mu + \mathcal{O}(\mu^3)
\end{equation}
Substituting this into \cref{2pdetSlambda} and simplifying, we obtain the equation
\begin{equation}\label{2detBeqmu}
\begin{aligned}
\det S(&\mu) = \left(-2 c^2 \mu^2 M (2a + c^2 \mu^2 M) + R_1 )\right) \sinh(\mu X) \\
&-4 M M^c c^4 \mu^4 ( q(X_0) \sinh(\mu X_0) + q(X_1) \sinh(\mu X_1) ) \cosh(\mu X) + R_2
\end{aligned}
\end{equation}
Incorporating the higher order terms from \cref{2plambdamu} into the remainder terms, the bounds on the remainder terms are unchanged.
\begin{equation}\label{muRbounds}
\begin{aligned}
|R_1| \leq C(r^{1/2} + |\mu|)^5 \\
|R_2| \leq C(r^{1/2} + |\mu|)^6
\end{aligned}
\end{equation}

To conclude this section, we prove that Hamiltonian symmetry applies to $\mu$ as well.

\begin{lemma}\label{lemma:Hamsymmmu}
If $\mu$ is a zero of $S(\mu)$, so are $-\mu$, $\overline{\mu}$, and $-\overline{\mu}$.
\begin{proof}
If $\mu$ is a zero, then $\lambda = \nu^{-1}(\mu)$ is a zero of $S(\lambda)$. By Hamiltonian symmetry, $-\lambda$, $\overline{\lambda}$, and $-\overline{\lambda}$ are also zeros of $S(\lambda)$. By \cref{nulambdalemma},
\begin{align*}
\nu(-\lambda) &= -\nu(\lambda) = -\mu \\
\nu(\overline{\lambda}) &= \overline{ \nu(\lambda) } = \overline{\mu} \\
\nu(-\overline{\lambda}) &= -\overline{ \nu(\lambda) } = -\overline{\mu},
\end{align*}
it follows that $-\mu$, $\overline{\mu}$, and $-\overline{\mu}$ are all zeros of $S(\mu)$.
\end{proof}
\end{lemma}

\subsection{Proof of \cref{lemma:chara}}

\begin{enumerate}
	\item Proof of part (i) is straightforward and will be filled in.
	\item Proof of part (ii) is not complete, but numerics strongly suggests result.
	\item Proof of \cref{tildeas1limit} is as follows.

	From Lemma \ref{lemma:ajparam} and the proof of Lemma \ref{armpersists},
	\begin{align*}
	\tilde{a}_1(r, s_1) &= -s_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}s_1} \left( \beta \cos s_1 - \alpha \sin s_1 \right) + \mathcal{O}(r^{\gamma/2\alpha_0}) \\
	&= \mathcal{O}\left(r^{\gamma/2\alpha_0} + e^{-\frac{1}{\rho}s_1} \right)
	\end{align*}
	From Lemma \ref{lemma:ajparam}, the proof of Lemma \ref{armpersists}, and the bound on $\theta^*(\theta, m)$ from Lemma \ref{thetaparamlemma}, 
	\begin{align*}
	\tilde{a}_0(r, m_0, s_1) &= -s_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}m_0} \left( \beta \cos\left(m_0 \pi + \mathcal{O}\left(e^{-\frac{1}{\rho}s_1} \right) \right) - \alpha \sin \left(m_0 \pi + \mathcal{O}\left(e^{-\frac{1}{\rho}s_1} \right) \right) \right) + \mathcal{O}\left(r^{\gamma/2\alpha_0} + e^{-\frac{1}{\rho}s_1} \right) \\
	&= -(-1)^{m_0} s_0 \beta_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}m_0} + \mathcal{O}\left(r^{\gamma/2\alpha_0} + e^{-\frac{1}{\rho}s_1} \right) \\
	&= \tilde{a}^*(m_0) + \mathcal{O}\left(r^{\gamma/2\alpha_0} + e^{-\frac{1}{\rho}s_1} \right) \\
	\end{align*}
	where $\tilde{a}^*(m_0)$ is defined by
	\[
	\tilde{a}^*(m_0) = (-1)^{m_0 + 1} s_0 \beta_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}m_0}
	\]
	and is negative if $m_0 = 0$ and positive if $m_0 = 1$. Equation \cref{tildeas1limit} follows by taking $r = 0$.
\end{enumerate}

\subsection{Asymmetric periodic 2-pulse}\label{sec:assymkernel}

Let $r_*$ be as in Theorem \ref{2pulsebifurcation}. Choose $m_0 \in \{ 0, 1\}$ and any $s_1 > p^*$. For $r \leq r_*$, let $Q_2(x; r = Q_2(x; m_0, s_1, r)$ be the corresponding family of asymmetric periodic 2-pulses. Choose any positive integer $N$, and let $\delta(N,r)$ be as in Theorem \ref{blockmatrixtheorem}. Let $\tilde{a}(r) = \tilde{a}(r; m_0, s_1)$, be as in Lemma \cref{lemma:chara}. By Lemma \cref{lemma:chara}, $\tilde{a}(0) \neq 0$. Let
\begin{equation}\label{2ptildemustar}
\tilde{\mu}_*(r) = \sqrt{-\frac{2\tilde{a}(r)}{M c^2}}.
\end{equation}
Since $\tilde{a}(0) \neq 0$, $\tilde{\mu}_*(0) \neq 0$
We expect to find a pair of interaction eigenvalues near $\mu = \pm \tilde{\mu}_*(r) r^{1/2}$. 

To make sure that the essential spectrum eigenvalues are ``out of the way'' of the interaction eigenvalues, we will choose $r_0 \leq r_*$ sufficiently small so that for all $r \leq r_0$,
\begin{equation}\label{2pnobubble}
\left|\tilde{\mu}_*(r) \right| r^{1/2}  \leq \frac{\pi}{2 X(r)},
\end{equation}
where $X(r)$ is the domain size. Precisely, since
\[
X(r) \leq \frac{1}{2 \alpha_0} 2 |\log r| + \frac{1}{2\beta_0}\left( s_1 + 2 \pi \right) + 2 L_0, 
\]
choose $r_0 \leq r_*$ such that
\begin{align}\label{2pnobubblecond}
\left|\tilde{\mu}_*(r) \right| r^{1/2} \left( \frac{1}{\alpha_0} |\log r| + \frac{1}{2\beta_0}\left( s_1 + 2 \pi \right) + 2 L_0 \right) \leq \frac{\pi}{2}
\end{align}
for all $r \leq r_0$. Since $r^{1/2}|\log r| \rightarrow 0$ as $r \rightarrow 0$ and $\tilde{\mu}_*(r)$ is bounded, we can always find such a $r_0$. This guarantees that \cref{2pnobubble} is satisfied. For the rest of this section, we will take $r \leq r_0$.

\subsubsection{Essential spectrum eigenvalues}

In this section, we find the essential spectrum eigenvalues. Let $N_1 \leq N$ be the largest positive integer such that $N_1/|\log r| < \delta(N,r)$. Let $m$ be a nonzero integer with $|m| \leq N_1$, and let
\begin{equation}\label{defmum}
\mu_m = \frac{m \pi i}{X} + \frac{h}{X}
\end{equation}
Expanding the $\sinh(\mu_m X)$ and $\cosh(\mu_m X)$ terms in \cref{2detBeqmu} in a Taylor series about $m \pi/X$,
\begin{align*}
\sinh(\mu_m X) &= (-1)^m h + \mathcal{O}(h^3) \\
\cosh(\mu_m X) &= (-1)^m + \mathcal{O}(h^2)
\end{align*}
By \cref{lemma:expnubound}, the $\sinh(\mu_m X_j)$ terms in \cref{2detBeqmu} are bounded by a constant. The terms involving $q(X_j)$ are $\mathcal{O}(r^{1/2})$. By \cref{2pnobubble}, $|\mu_m| \geq C r^{1/2}$ for $r \leq r_0$. Substituting these into \cref{2detBeqmu}, we have 
\begin{equation}\label{Bess1}
\begin{aligned}
\det &S(h, r) = \left(-2 c^2 M  \mu_m^2 \left( 2a(r) + c^2 M \mu_m \right)^2 + \mathcal{O}( |\mu_m|)^5 \right) \left( (-1)^m h + \mathcal{O}(h^3) \right) \\
&+ \mu_m^4 \left( (-1)^m + \mathcal{O}(h^2)\right)\mathcal{O}(r^{1/2}) + \mathcal{O}\left( |\mu_m| \right)^6 \\
&= \left(-2 c^2 M  \mu_m^2 \left( 2a + c^2 M \mu_m \right)^2 + \mathcal{O}( |\mu_m|)^5 \right) \left( (-1)^m h + \mathcal{O}(h^3) \right) + \mathcal{O}\left( |\mu_m|^5 \right),
\end{aligned}
\end{equation}

We want to solve $\det S(\mu, r) = 0$. Dividing by $(-1)^m$, $M c^2$, and the constants out front and using \cref{2ptildemustar}, we want to solve 
\begin{equation}\label{Bess2}
\begin{aligned}
\left(\mu_m^2 (\mu_m - \tilde{\mu}_*(r)r^{1/2})(\mu_m + \tilde{\mu}_*(r)r^{1/2}) + \mathcal{O}( |\mu_m|)^5 \right) \left( h + \mathcal{O}(h^3) \right) + \mathcal{O}\left( |\mu_m|^5 \right) = 0
\end{aligned}
\end{equation}
Since $\mu_m \neq 0$, divide by $\mu_m^2$ to get
\begin{equation}\label{Bess3}
\begin{aligned}
\left((\mu_m - \mu_*(r))(\mu_m + \mu_*(r)) + \mathcal{O}( |\mu_m|)^3 \right) \left( h + \mathcal{O}(h^3) \right) + \mathcal{O}\left( |\mu_m|^3 \right) = 0
\end{aligned}
\end{equation}
Finally, multiply by $X^2$ and substitute \cref{defmum} for $\mu_m$. Since $|m| \leq N$, $|\mu_m| \leq C N/X$, so we can simplify the remainder terms to get the equation $G_m(h, r) = 0$, where
\begin{equation}\label{Bess4}
\begin{aligned}
G_m(h, r) &= (m \pi i + h - \tilde{\mu}_*(r) r^{1/2} X(m \pi i + h + \tilde{\mu}_*(r) r^{1/2} X \left( h + \mathcal{O}(h^3) \right) + \mathcal{O}\left( \frac{1}{X} \right)
\end{aligned}
\end{equation}
Since $X = X(r) = \mathcal{O}(1/|\log r|)$, this becomes
\begin{equation}\label{Bess4}
\begin{aligned}
G_m(h, r) &= \left( m \pi i + h + \mathcal{O}(r^{1/2}|\log r|) \right)\left(m \pi i + h + + \mathcal{O}(r^{1/2}|\log r|) \right) \left( h + \mathcal{O}(h^3) \right) + \mathcal{O}\left( \frac{1}{|\log r|} \right)
\end{aligned}
\end{equation}
Since $r^{1/2}|\log r| \rightarrow 0$ as $r \rightarrow 0$,
\begin{align*}
G_m(0,0) &= 0 \\
\partial_h G_m(0,0) &= -m^2 \pi^2
\end{align*}
For all $m$ between 1 and $N_1$, $|\partial_h G_m(0,0)| \geq \pi^2 > 0$. Thus we can use the implicit function theorem to solve for $h$ in terms of $r$ near $h = 0$. Specifically, there exists $r_2^m \leq r_0$ and a unique smooth function $h_m(r)$ with $h_m(0) = 0$ such that for all $r \leq r_2^m$, $G_m(h_m(r),r) = 0$. Expanding $h_m$ in a Taylor series about $r = 0$,
\[
h_m(r) = \mathcal{O}\left( \frac{1}{|\log r|} \right)
\]
Let $r_2 = \min\{ r_2^1, \dots, r_2^{N_1} \}$. Substituting $h_m(r)$ into \cref{defmum}, for all nonzero integers $m = 1, \dots, N_1$, there are essential spectrum eigenvalues located at
\[
\mu_m(r) = \frac{m \pi i}{X} + \mathcal{O}\left( \frac{1}{|\log r|^2} \right)
\]
Changing variables back to $\lambda$, these are located at
\[
\lambda_m(r) = c \frac{m \pi i}{X}\left[1 + \mathcal{O}\left( \frac{1}{|\log r|^2} \right) \right] +\mathcal{O}\left( \frac{1}{|\log r|^2} \right)
\]
Since $X = \mathcal{O}(|\log r|)$, this simplifies to
\[
\lambda_m(r) = c \frac{m \pi i}{X} +\mathcal{O}\left( \frac{1}{|\log r|^2} \right)
\]

By Hamiltonian symmetry, eigenvalues must come in quartets. Since there is nothing else above the real axis with similar magnitude, $\lambda_m(r)$ is pure imaginary and there is another essential spectrum eigenvalue $\lambda_{-m}(r) = -\lambda_m(r)$. We conclude that the nonzero essential spectrum eigenvalues are given by $\lambda = \pm \lambda_m^{\text{ess}}(r)$ for $m = 1, \dots, N_1$, where
\[
\lambda_m^{\text{ess}}(r) = c \frac{m \pi i}{X} + +\mathcal{O}\left( \frac{1}{|\log r|^2} \right),
\]

\subsubsection{Eigenvalues at 0}

In this section, we show that there are exactly three eigenvalues at 0, and that there are no other eigenvalues within a certain distance of 0. We know that there is an eigenvalue at 0 with at least algebraic multiplicity 2, since the corresponding eigenfunctions are $\partial_x Q_2(x)$ and $\partial_c Q_2(x)$. Since $\tilde{a}(0) \neq 0$, the eigenvalues of $\tilde{A}(0)$, thus by \cref{lemma:centereigenfn}, there is a third eigenfunction $V_n^c(x)$ with eigenvalue 0. We will use Rouch\'{e}'s theorem to show that there are no more eigenfunctions in a small circle around 0. Let
\[
\tilde{\xi} = \frac{1}{2}|\tilde{\mu}_*(0)|
\]
and take $\mu$ on the circle $|\mu| = r^{1/2} \tilde{\xi}$. By \cref{2pnobubble}, $|\mu X| \leq 1/2$, thus we can expand all of the $\sinh$ and $\cosh$ terms in \cref{2detBeqmu} in a Taylor series about 0 to get
\begin{equation*}
\begin{aligned}
\sinh(\mu X) &= \mu X + \mathcal{O}(\mu X^2) \\
\cosh(\mu X) &= \mathcal{O}(1) \\
\sinh(\mu X_j) &= \mathcal{O}(\mu X_j) = \mathcal{O}(\mu X).
\end{aligned}
\end{equation*}
Using these estimates, the estimate $q(X_j) = \mathcal{O}(r^{1/2})$, and \cref{2ptildemustar}, equation \cref{2detBeqmu} simplifies to
\begin{equation}\label{2detBeqmu3}
\begin{aligned}
\det S(\mu, r) &= -2 \mu^2 M (\mu - \tilde{\mu}_*(r)r^{1/2}) (\mu + \tilde{\mu}_*(r)r^{1/2}) ( \mu X + \mathcal{O}(\mu X)^3) + \mathcal{O}\left( r^{5/2}|\mu|X + |\mu|^5(r^{1/2} + |\mu|)X \right),
\end{aligned}
\end{equation}
Rescale the problem by taking $\mu = r^{1/2}\tilde{\mu}$. Then equation \cref{2detBeqmu3} becomes
\begin{equation}\label{2detBeqmu4}
\begin{aligned}
\det S(\tilde{\mu}, r) &= -2 \tilde{\mu}^2 M r^{5/2} (\tilde{\mu} - \tilde{\mu}_*(r)) (\tilde{\mu} + \tilde{\mu}_*(r))( \tilde{\mu} X + \mathcal{O}(\tilde{\mu}^3 r X^3) + \mathcal{O}\left( r^3 X \right)
\end{aligned}
\end{equation}
By \cref{lemma:ajparam}, $\tilde{\mu}_*(r) = \tilde{\mu}_*(0) + \mathcal{O}(r^{\gamma/4 \alpha)}$, thus \cref{2detBeqmu4} becomes
\begin{equation}\label{2detBeqmu5}
\begin{aligned}
\det S(\tilde{\mu}, r) &= -2 \tilde{\mu}^2 M r^{5/2} (\tilde{\mu} - \tilde{\mu}_*(0)) (\tilde{\mu} + \tilde{\mu}_*(0))( \tilde{\mu} X + \mathcal{O}(\tilde{\mu}^3 r X^3) + \mathcal{O}\left( r^{5/2} \left( r^{1/2} + r^{\gamma/4 \alpha)} \right) X \right)
\end{aligned}
\end{equation}
We are looking for zeros of \cref{2detBeqmu5}. Dividing by $r^{5/2}X$ and the constants out front and using the estimate $X = \mathcal{O}(|\log r|)$, we wish to solve $G(\tilde{\mu}, r) = 0$, where
\begin{equation}\label{2peigG}
G(\tilde{\mu}, r) = -2 \tilde{\mu}^3 M (\tilde{\mu} - \tilde{\mu}_*(0)) (\tilde{\mu} + \tilde{\mu}_*(0)) + \mathcal{O}\left( r |\log r|^2  + r^{1/2} + r^{\gamma/4 \alpha} \right)
\end{equation}
In particular, we wish to show that $G(\tilde{\mu}, r)$ has exactly three zeros inside the circle of radius $\tilde{\xi}$. Let $G(\tilde{\mu}, r) = G_1(\tilde{\mu}) + G_2(\tilde{\mu}, r)$, where 
\[
G_1(\tilde{\mu}) = -2 \tilde{\mu}^3 M (\tilde{\mu} - \tilde{\mu}_*(0)) (\tilde{\mu} + \tilde{\mu}_*(0)),
\]
which is independent of $r$, and
\[
G_2(\tilde{\mu}, r) = \mathcal{O}\left( r |\log r|^2 + \frac{1}{|\log r|} \right).
\]
On the circle $|\tilde{\mu}| = \tilde{\xi}$,
\[
|G_1(\tilde{\mu})| \geq \frac{|M|}{16}|\tilde{\mu}_*(0)|^5
\]
Since $|G_2(\tilde{\mu}, r)| \rightarrow 0$ as $r \rightarrow 0$ and $\tilde{\mu}_*(0) \neq 0$, there exists $r_3 \leq r_0$ such that for $r \leq r_3$, $|G_2(\tilde{\mu}, r)| < |G_1(\tilde{\mu})|$ on the circle $|\tilde{\mu}| = \tilde{\xi}$. By Rouch\'{e}'s theorem $G(\tilde{\mu}, r)$ and $G_1(\tilde{\mu})$ have the same number of zeros (counted with multiplicity) inside the circle of radius $\tilde{\xi}$. By the choice of $\tilde{\xi}$, $G_1(\tilde{\mu})$ has exactly 3 zeros inside the circle, thus $G(\tilde{\mu}, r)$ does as well. Undoing the scaling and changing variables back to $\lambda$, for $r \leq r_2$, there are exactly three eigenvalues inside a circle of radius $\sqrt{|2\tilde{a}(0)/M|}r^{1/2}$. These must correspond to the three kernel eigenvalues discussed above.

\subsubsection{Interaction eigenvalues}\label{sec:assyminteigs}

In this section, we will find the interaction eigenvalues. Using the same setup and scaling as in the previous section, simplify the remainder terms in \cref{2detBeqmu4} to get
\begin{equation}\label{2detint2}
\begin{aligned}
\det S(\tilde{\mu}, r) &= -2 M r^{5/2} \tilde{\mu}^3 (\tilde{\mu} - \tilde{\mu}_*(r)) (\tilde{\mu} + \tilde{\mu}_*(r)) X + \mathcal{O}\left( r^{7/2} X^3 + r^3 X \right)
\end{aligned}
\end{equation}
Dividing by $r^{5/2}X$ and the constants out front and using the estimate $X = \mathcal{O}(|\log r|)$, we wish to solve $G(\tilde{\mu}, r) = 0$, where
\begin{equation}\label{2detintG1}
\begin{aligned}
G(\tilde{\mu}, r) &= -2 M (\tilde{\mu} - \tilde{\mu}_*(r)) (\tilde{\mu} + \tilde{\mu}_*(r))\tilde{\mu}^3 + \mathcal{O}\left( r |\log r|^2 + r^{1/2} \right)
\end{aligned}
\end{equation}
We expect to find the interaction eigenvalues near $\tilde{\mu} = \pm \tilde{\mu}_*(r)$. By symmetry, we only need to consider one of these. Let
\[
\tilde{\mu} = \tilde{\mu}_*(r) + \tilde{h}
\]
Then \cref{2detintG1} becomes
\begin{equation}\label{2detintG2}
\begin{aligned}
G(\tilde{h},r) = \tilde{h} ( \tilde{h} + \tilde{\mu}_*(r))^3 (\tilde{h} + 2 \tilde{\mu}_*(r)) + \mathcal{O}\left( r |\log r|^2 + r^{1/2} \right)
\end{aligned}
\end{equation}
Since $r |\log r|^2  \rightarrow 0$ as $r \rightarrow 0$,
\begin{align*}
G(0, 0) &= 0 \\
\partial_{\tilde{h}} G(0, 0) &= 2 \tilde{\mu}_*(0)^4
\end{align*}
Since $\tilde{\mu}_*(0) \neq 0$, we can use the implicit function theorem to solve $G(\tilde{h},r) = 0$ for $\tilde{h}$ in terms of $r$ near $\tilde{h} = 0$. Specifically, there exists $r_4 \leq r_0$ and a unique smooth function $\tilde{h}(r)$ with $\tilde{h}(0) = 0$ such that for all $r \leq r_4$, $G(\tilde{h}, r) = 0$. Expanding $\tilde{h}(r)$ in a Taylor series about $r = 0$, for all $r \leq r_4$,
\[
\tilde{h}(r) = \mathcal{O}\left( r |\log r|^2 + r^{1/2} \right) = \mathcal{O}\left( r^{1/2} \right)
\]
Undoing the scaling, there is an interaction eigenvalue located at
\begin{align*}
\mu(r) = \sqrt{-\frac{\tilde{a}(r)}{M c^2}}r^{1/2} + \mathcal{O}\left( r \right)
\end{align*}
Changing variables back to $\lambda$, this is located at
\begin{align*}
\lambda(r) = \sqrt{-\frac{2 \tilde{a}(r)}{M}}r^{1/2} + \mathcal{O}\left( r \right)
\end{align*}
By Hamiltonian symmetry there is also an eigenvalue at $-\lambda(r)$. Since Hamiltonian symmetry  dicatates that eigenvalues must come in quartets, and there only two eigenvalues of this magnitude, we conclude that for $r \leq r_4$, there is a pair of interaction eigenvalues given by
\[
\lambda^{\text{int}}(r) = \pm \left( \sqrt{ -\frac{2 \tilde{a}(r)}{M} }r^{1/2} + \mathcal{O}\left( r \right) \right)
\]
which are real if $\tilde{a}(0) < 0$ and purely imaginary if $\tilde{a}(0) > 0$. By \cref{lemma:chara}, the sign of $\tilde{a}(0)$ depends only on $m_0$.

\subsubsection{Eigenvalue count}

Finally, we prove that we have accounted for all of the eigenvalues near 0. Let $N_1$ be as above, and let
\[
\xi = \left( N_1 + \frac{1}{2} \right)\pi
\]
Take $\mu$ on the circle $|\mu| = \xi/X$. We will use Rouch\'{e}'s theorem to show that there are no zeros of $\det S(\mu)$ inside the circle of radius $\xi$ besides the ones we have already found.

Substituting \cref{2ptildemustar} into \cref{2detBeqmu} and dividing by the constants out front, we are looking to solve
\begin{equation}\label{Gcount1}
\begin{aligned}
0 &= \mu^2 (\mu - \tilde{\mu}_*(r)r^{1/2}) (\mu + \tilde{\mu}_*(r)r^{1/2}) \sinh(\mu X) \\
&\qquad +2 M^c c^2 \mu^4 ( q(X_0) \sinh(\mu X_0) + q(X_1) \sinh(\mu X_1) ) \cosh(\mu X) + R_1\sinh(\mu X) + R_2
\end{aligned}
\end{equation}
This time, we rescale the problem by taking $\mu = h/X$. Making this substitution, equation \cref{Gcount1} becomes
\begin{equation}\label{Gcount2}
\begin{aligned}
0 &= \left(\frac{h}{X}\right)^2 \left( \frac{h}{X} - \tilde{\mu}_*(r)r^{1/2}\right)\left(\frac{h}{X} + \tilde{\mu}_*(r)r^{1/2}\right) \sinh(h) \\
&\qquad +2 M^c c^2 \left(\frac{h}{X}\right)^4 \left( q(X_0) \sinh\left(h \frac{X_0}{X} \right) + q(X_1) \sinh\left(h \frac{X_1}{X} \right) \right) \cosh(h) + R_1\sinh(h) + R_2
\end{aligned}
\end{equation}
Multiplying by $X^4$, we wish to find the zeros of $G(h, r)$, which is given by
\begin{equation}\label{Gcount3}
\begin{aligned}
G(h,r) &= h^2 \left( h - \tilde{\mu}_*(r)r^{1/2}X\right)\left(h + \tilde{\mu}_*(r)r^{1/2}X\right) \sinh(h) \\
&\qquad +2 M^c c^2 h^4 \left( q(X_0) \sinh\left(h \frac{X_0}{X} \right) + q(X_1) \sinh\left(h \frac{X_1}{X} \right) \right) \cosh(h) + (R_1\sinh(h) + R_2)X^4
\end{aligned}
\end{equation}
Write $G(h,r) = G_1(h) + G_2(h,r)$, where
\[
G_1(h, r) = h^2 \left( h - \tilde{\mu}_*(r)r^{1/2}X\right)\left(h + \tilde{\mu}_*(r)r^{1/2}X\right) \sinh(h)
\]
and
\[
G_2(h,r) = 2 M^c c^2 h^4 \left( q(X_0) \sinh\left(h \frac{X_0}{X} \right) + q(X_1) \sinh\left(h \frac{X_1}{X} \right) \right) \cosh(h) + (R_1\sinh(h) + R_2)X^4
\]
On a circle of radius $|h| = \xi$, $|\sinh h| \geq 1$. By \cref{2pnobubble}, $|h - \tilde{\mu}_*(r)r^{1/2}X|\geq \pi$. Thus on the circle $|h| = \xi$
\[
|G_1(h,r)| \geq \pi^2 \xi^2,
\]
which is independent of $r$. For $G_2(h,r)$, using $q(X_j) = \mathcal{O}(r^{1/2})$, $X = \mathcal{O}(|\log r|)$, the remainder bounds for $R_1$ and $R_2$ from \cref{muRbounds}, and the scaling $\mu = h/X$, on the circle of radius $|h| = \xi$, we have
\[
|G_2(h,r)| = \mathcal{O}\left( r^{1/2} + \frac{1}{|\log r|} \right)
\]
Since $|G_2(h,r)| \rightarrow 0$ as $r \rightarrow 0$, there exists $r_5 \leq r_0$ such that for all $r \leq r_5$, $|G_2(h,r)| < |G_1(h,r)|$ on the circle $|h| = \xi$. Thus by Rouch\'{e}'s theorem, $G(h,r)$ and $G_1(h,r)$ have the same number of zeros (counted with multiplicity) inside the circle $|h| = \xi$. By our choice of $\xi$, $G_1(h,r)$, thus $G(h,r)$, has $2 N_1 + 5$ zeros inside this circle, which correspond exactly to the 3 eigenvalues at 0, the two interaction eigenvalues, and the first $2 N_1$ nonzero essential spectrum eigenvalues. Since we have accounted for all the zeros of $G(h,r)$, we conclude that there can be no more zeros of $G(h,r)$ inside the circle $|h| = \xi$. Undoing the scaling and changing variables back to $\lambda$, we have shown that there are no other eigenvalues inside a circle with radius slightly larger than $|\lambda_{N_1}^{\text{ess}}(r)|$.

\subsubsection{Proof of \cref{theorem:2peigsassym}}

The proof of \cref{theorem:2peigsassym} follows from combining the results of the previous four subsections and taking $r_1 = \min\{ r_2, r_3, r_4, r_5 \}$.

\subsection{Proof of \cref{2peigsym}}

To prove \cref{2peigsym}, we will first show that if we are sufficiently close to the bifurcation point, there are five eigenvalues in a small ball around the origin. We will then show that when were are at the bifurcation point, those eigenvalues are actually all at the origin.

\subsubsection{Count of eigenvalues near 0}

From the proof of \cref{lemma:chara}, for $m_1 \in \{0, 1\}$ and $s_0 \in [0, \pi)$,
\begin{align*}
\tilde{a}(r) = \tilde{a}(r, s_0) &= 2 (-1)^{m_0} s_0 \alpha_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}(m_0 \pi + s_0) } \left( \rho \cos s_0 - \sin s_0 \right) + \mathcal{O}\left(r^{\gamma/2\alpha_0} \right)\\
\end{align*}
and $\tilde{a}(0) = 0$ if and only if $s_0 = p^*$. Since $\tilde{a}(r)$ is smooth in $s_0$ and $r$, there exist $\eta > 0$ and $r_2 \leq r_*$ such that for all $r \leq r_r$ and $s_0 \in (p^* - \eta, p^* + \eta)$, 
\begin{equation}
\sqrt{ \left| \frac{ 2 \tilde{a}(r, s_0) }{M} \right| }  r^{1/2} \leq \frac{\pi}{2 X(r)}
\end{equation}
Since $X(r) = \mathcal{O}(|\log r|)$, this is always possible. Let $\xi = c \pi / 2 X(r)$, and follow the same procedure as in \cref{sec:assymkernel}. Using Rouch\'{e}'s theorem, it follows that for $r \leq r_1$ and $s_0 \in (p^* - \eta, p^* + \eta)$, there are exactly 5 zeros of $S(\lambda)$ inside the circle of radius $\xi$. We know that two of the zeros must be at $\lambda = 0$ since they correspond to the kernel eigenfunctions $\partial_x Q_2(x)$ and $\partial_c Q_2(x)$. This leaves three eigenvalues unaccounted for.
By Hamiltonian symmetry, since eigenvalues must come in quartets, there must be a third eigenvalue at 0.

\subsubsection{Eigenvalues at bifurcation point}
Using the scaling $\mu = r^{1/2} \tilde{\mu}$ and following the same steps as in \cref{sec:assyminteigs}, we wish to solve
\begin{equation*}
\begin{aligned}
0 &= -2 M (\tilde{\mu} - \tilde{\mu}_*(r)) (\tilde{\mu} + \tilde{\mu}_*(r))\tilde{\mu}^3 + \mathcal{O}\left( r |\log r|^2 + r^{1/2} \right)
\end{aligned}
\end{equation*}
Since we know that there will always be two eigenvalues at 0 corresponding to $\partial_x Q_n(x)$ and $\partial_c Q_n(x)$ and we proved the existence of a third eigenvalue at 0 in the previous section, we can divide by $\tilde{\mu}^3$ and the constants out front to get 
\begin{align*}
0 &= (\tilde{\mu} - \tilde{\mu}_*(r)) (\tilde{\mu} + \tilde{\mu}_*(r)) + \mathcal{O}\left( r |\log r|^2 + r^{1/2} \right) \\
&= \tilde{\mu}^2 - \tilde{\mu}_*(r)^2 + \mathcal{O}\left( r |\log r|^2 + r^{1/2} \right) \\
&= \tilde{\mu}^2 + \frac{2\tilde{a}(r)}{M c^2} + \mathcal{O}\left( r |\log r|^2 + r^{1/2} \right) \\
\end{align*}
Using the expression for $\tilde{a}(r)$ from \cref{lemma:chara}, this become
\begin{equation}\label{Gsymm1}
0 = \tilde{\mu}^2 + \frac{2\tilde{a}(0, s_0)}{M c^2} + \mathcal{O}\left( r |\log r|^2 + r^{1/2} + r^{\gamma/2\alpha_0} \right)
\end{equation}
Since we are interested in what happens near $s_0 = p^*$, let $s_0 = p^* + h$. Substituting this for $s_0$ into $\tilde{a}(0, s_0)$ and expanding in a Taylor series, we have
\begin{align*}
\tilde{a}(0, p^* + h) &= 2 (-1)^{m_0} s_0 \alpha_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}(m_0 \pi + p^*) } e^{-\frac{1}{\rho}h }\left( \rho \cos(p^* + h) - \sin(p^* + h) \right) \\
&= 2 (-1)^{m_0} s_0 \alpha_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}(m_0 \pi + p^*) }\left( 1 - \frac{1}{\rho}h + \mathcal{O}(|h|^2) \right) \left( -\frac{2}{\sqrt{1 + \rho^2} }h + \mathcal{O}(|h|^2) \right) \\
&= -\frac{4}{\sqrt{1 + \rho^2} }(-1)^{m_0} s_0 \alpha_0 e^{\alpha_0 \phi/\beta_0} e^{-\frac{1}{\rho}(m_0 \pi + p^*) }h + \mathcal{O}(|h|^2)
\end{align*}
Since the coefficient of $h$ is a constant, we can write this as
\[
\tilde{a}(p^* + h, 0) = C_1 h + \mathcal{O}(|h|^2) 
\]
where $C_1 \neq 0$. Substituting this into \cref{Gsymm1}, we wish to solve the equation the equation $G(\tilde{\mu}, h, r) = 0$, where
\begin{equation}\label{Gsymm1}
G(\tilde{\mu}, h, r) = \tilde{\mu}^2 + \frac{2C_1}{M c^2}h + \mathcal{O}\left( |h|^2 + r |\log r|^2 + r^{1/2} + r^{\gamma/2\alpha_0} \right).
\end{equation}
When $r = 0$ and $h = 0$, $G(\tilde{\mu}, h, r)$ has a double root at $\tilde{\mu} = 0$. We wish to show that this double root at $\tilde{\mu} = 0$ persists for small $r$.

For $\tilde{\mu}$ to be a double root, it must solve both $G(\tilde{\mu}, h, r) = 0$ and $\partial_{\tilde{\mu}} G(\tilde{\mu}, h, r) = 0$. Define $K(\tilde{\mu}, h, r)$ by
\begin{equation}
K(\tilde{\mu}, h, r) = 
\begin{pmatrix}G(\tilde{\mu}, h, r) \\ \partial_{\tilde{\mu}}G(\tilde{\mu}, h, r) \end{pmatrix} 
= \begin{pmatrix}
\tilde{\mu}^2 + \frac{2C_1}{M c^2}h \\
2 \tilde{\mu}
\end{pmatrix}
+ \mathcal{O}\left( |h|^2 + r |\log r|^2 + r^{1/2} + r^{\gamma/2\alpha_0} \right)
\end{equation}
When $r = 0$, $K(\tilde{\mu}, 0, 0) = 0$. The Jacobian with respect to $(\tilde{\mu}, h)$ is
\[
D_{(\tilde{\mu}, h)}K(\tilde{\mu}, h, r) = 
\begin{pmatrix}
2 \tilde{\mu} & \frac{2C_1}{M c^2} \\
2 & 0
\end{pmatrix}
+ \mathcal{O}\left( |h| + r |\log r|^2 + r^{1/2} + r^{\gamma/2\alpha_0} \right)
\]
At $(\tilde{\mu}, h) = (0,0)$, 
\[
D_{(\tilde{\mu}, h)}K(\tilde{\mu}, h, r)\Big|_{(0,0)} = 
\begin{pmatrix}
0 & \frac{2C_1}{M c^2} \\
2 & 0
\end{pmatrix},
\]
which is nonsingular since all the constants in the upper right block are nonzero. Using the implicit function theorem, we can solve for $(\tilde{\mu}, h)$ in terms of $r$ for sufficiently small $r$. pecifically, there exists $r_1 \leq r_2$ and a unique smooth function $(\tilde{\mu}, h)(r)$ with $(\tilde{\mu}, h)(0) = (0, 0)$ such that for all $r \leq r_1$, $K(\tilde{\mu}(r), h(r), r) = 0$. For $r \leq r_1$ and $h = h(r)$, $\tilde{\mu}(r)$ is a double root of $G(\tilde{\mu}, h, r)$. By Hamiltonian symmetry, we must have $\tilde{\mu}(r) = 0$. Expanding $h(r)$ in a Taylor series about $r$, 
\begin{equation*}
h(r) = \mathcal{O}\left( r |\log r|^2 + r^{1/2} + r^{\gamma/2\alpha_0} \right)
\end{equation*}

We conclude that when $s_0 = p^* + h(r)$, there are two more eigenvalues at 0. From the previous section, there are 5 zeros of $S(\lambda)$ inside a the circle of radius $\xi$. Thus when $s_0 = p^* + h(r)$, there is an eigenvalue at 0 with algebraic mutiplicty 5. Since the pitchfork bifurcation in the family of periodic 2-pulses occurs near $p^*$ at $p^*(r)$, it follows from standard PDE bifurcation theory that this quintuiple zero must occur at the pitchfork bifurcation point, i.e. $p^* + h(r) = p^*(r)$.

\section{Proof of Theorem \ref{theorem:kreinbubbles}}

\subsection{Proof of \cref{lemma:s1choice}}

We wish to solve
\begin{equation}\label{solvefors1}
\frac{c \pi}{X(r, m_0, s_1)} = \lambda^*(r) r^{1/2}
\end{equation}
for $s_1$ in terms of $r$. We note that $\lambda_*(r)$ is independent of $s_1$. Substituting \cref{X2pdomain} from \cref{2pulsebifurcation} and rearranging, equation \cref{solvefors1} becomes
\begin{align*}
\lambda_*(r) r^{1/2} \left( \frac{1}{\alpha_0} |\log r| + \frac{1}{2\beta_0} (m_0 \pi + s_1 ) + 2 L_0 + \mathcal{O}\left(e^{-\frac{1}{\rho}s_1}\right) \right) = c \pi
\end{align*}
Rearranging this, we obtain the equation $g(s_1) = h(r)$, where
\begin{align*}
g(s_1) &= s_1 + \mathcal{O}\left(e^{-\frac{1}{\rho}s_1}\right) \\
h(r) &= \frac{2 \beta_0 c \pi}{\lambda_*(r)} r^{-1/2} - \frac{2 \beta_0}{\alpha_0} |\log r| - m_0 \pi - 4 \beta_0 L_0
\end{align*}
Differentiating $g(s_1)$ with respect to $s_1$, 
\[
g'(s_1) = 1 + \mathcal{O}\left(e^{-\frac{1}{\rho}s_1}\right)
\]
Thus there exists $R > 0$ such that for all $s_1 \geq R$, $g'(s_1) > 1/2$. For $s_1 \geq R$, $g(s_1)$ is strictly increasing, thus invertible. Since $h(r) \rightarrow \infty$ as $r \rightarrow 0$, there exists $r_1 \leq r_*$ such that for all $r \leq r_1$, we can solve for $s_1$ to get
\[
s_1^*(r) = g^{-1}(h(r))
\]
This proves \cref{lemma:s1choice}.

\subsection{Variation of $s_1$}

For fixed $r$, as $s_1$ is varied near $s_1^*(r)$, the point $\frac{c \pi}{X(r, m_0, s_1)} i$ will pass through the point $\lambda_*(r) r^{1/2}i$ on the imaginary axis. We will now make this precise.

For $t \in [-1, 1]$, we wish to solve
\begin{equation}\label{solvefors2}
\frac{c \pi}{X(r, m_0, s_1)} = \left(1 + \frac{t}{2} \right)\lambda^*(r) r^{1/2}
\end{equation}
To do this, let
\begin{align*}
h(r, t) &= \frac{2 \beta_0 c \pi}{\left( 1 + \frac{t}{2} \right) \lambda_*} r^{-1/2} - \frac{2 \beta_0}{\alpha_0} |\log r| - m_0 \pi - 4 \beta_0 L_0
\end{align*}
Following the same argument as in the previous section, there exists $r_2 \leq r_1$ such that for all $r \leq r_2$, there exists a function $s_1: \mathcal{R} \times [-1, 1] \rightarrow \R$ such that for all $t \in [-1, 1]$, $g(s_1(r, t)) = h(r, t)$, $s_1(r, 1) = s_1^*(r)$, and $s_1(r, t)$ is strictly decreasing in $t$. By construction,
\begin{align*}
\frac{c \pi}{X(r, m_0, s_1(r, -1))} = \frac{1}{2} \lambda^*(r) r^{1/2} \\
\frac{c \pi}{X(r, m_0, s_1(r, 1))} = \frac{3}{2} \lambda^*(r) r^{1/2}
\end{align*}
Let $s_1^-(r) = s_1(r, -1)$, $s_1^+(r) = s_1(r, 1)$, and 
\[
I_s(r) = [s_1^-(r), s_1^+(r)]
\]
From this point forward we will always take $s_1 \in I_s(r)$.

Finally, we use this to obtain estimates which will be useful later. Since $|e^{-\frac{1}{\rho}s_1(r,t)} \leq 1|$, substituting $s_1(r, t)$ into $g(s_1) = h(r, t)$ (and decreasing $r_2$ if necessary), there exists a constant $R_s$ such that for all $r \leq r_2$ and $t \in [-1, 1]$, we have the lower bound
\begin{equation}\label{s1starLB}
s_1(r, t) \geq R_s r^{-1/2}
\end{equation}
Decreasing $r_2$ further, if necessary, and recalling the expression for $X_1$ from \cref{2pasymmdist}, we can guarantee that for all $r \leq r_2$, 
\begin{equation}\label{X0X1compare}
X_1(r, s_1) \geq 2 X_0(r, m_0, s_1)
\end{equation}

From Lemma \ref{lemma:chara} and \cref{deftildeastar},
\[
\tilde{a}(r, m_0, s_1) = \tilde{a}_*(r) + \mathcal{O}\left( e^{-\frac{1}{\rho}s_1} \right)
\]
Combining this with \cref{s1starLB}, we have
\begin{align}\label{tildeasub}
\tilde{a}(r; m_0, s_1) = \tilde{a}_*(r) + \mathcal{O}\left( r^{1/2} \right)
\end{align}
Let $X_0^*(r) = X_0(r, m_0, s_1^*(r))$. Then using \cref{s1starLB} with \cref{2pasymmdist}, for all $s_1 \in I_s(r)$,
\begin{align}\label{X0sub}
X_0(r, m_0, s_1) = X_0^*(r) + \mathcal{O}\left( r^{1/2} \right)
\end{align}
Similarly, for $s_1 \in I_s(r)$, let $\Delta s_1 = s_1^*(r) - s_1$. Then 
\begin{align}\label{Xsub}
X(r, m_0, s_1^*(r) + \Delta s_1) = X^*(r) + \frac{1}{2\beta_0}\Delta s_1 + \mathcal{O}\left( r^{1/2} \right)
\end{align}

Expanding $q(X_0(r, m_0, s_1))$ in a Taylor series about $s_1^*(r)$, for $s_1 \in I_s(r)$,
\begin{align}\label{qX0sub}
q( X_0(r, m_0, s_1) ) = q(X_0^*(r)) + \mathcal{O}\left(r \right)
\end{align}
since $q'(X_0^*(r)) = \mathcal{O}(r)$. Finally, using \cref{X0X1compare},
\begin{align}\label{qX1bound}
q(X_1(r, s_1)) = \mathcal{O}(r).
\end{align}

\subsection{Setup}

Since we will be changing variables by taking $\lambda = \nu^{-1}(\mu)$, let 
\begin{equation}\label{Kreinmustar1}
\tilde{\mu}_*(r) = \frac{1}{c} \tilde{\lambda_*}(r),
\end{equation}
which does not depend on $s_1$. We will solve $\det S(\mu) = 0$ for $\mu$ close to $\tilde{\mu}_* r^{1/2} i$, where $\det S(\mu)$ is given by \cref{2detBeqmu}.

Since we are looking for nonzero eigenvalues which are order $\mu = \mathcal{O}(r^{1/2})$, dividing \cref{2detBeqmu} by $\mu^2$ and the constants out front and simplifying, we obtain the equation
\begin{equation}\label{KreinB1}
\begin{aligned}
0 &= \left( (2a + c^2 \mu^2 M) + \mathcal{O}( r^{3/2} )\right) \sinh(\mu X) \\
&+ 2 c^2 \mu^2 M^c ( q(X_0) \sinh(\mu X_0) + q(X_1) \sinh(\mu X_1) ) \cosh(\mu X) + \mathcal{O}( r^2 ) 
\end{aligned}
\end{equation}

Since we are taking $s_1 \in I_s(r)$, it follows from \cref{tildeasub} and \cref{lemma:chara} that
\[
a = r \tilde{a}(r, m_0, s_1) = r\tilde{a}_*(r) + \mathcal{O}\left( r^{3/2} \right)
\]
Making this substitution, equation \cref{KreinB1} becomes
\begin{equation}\label{KreinB1a}
\begin{aligned}
0 &= \left( (2r\tilde{a}_*(r) + c^2 \mu^2 M) + \mathcal{O}( r^{3/2} )\right) \sinh(\mu X) \\
&+ 2 c^2 \mu^2 M^c ( q(X_0) \sinh(\mu X_0) + q(X_1) \sinh(\mu X_1) ) \cosh(\mu X) + \mathcal{O}( r^2 ) 
\end{aligned}
\end{equation}
Dividing by $M c^2$ and using \cref{Kreinmustar1}, equation \cref{KreinB1a} becomes
\begin{equation}\label{KreinB2}
\begin{aligned}
0 &= \left( (\mu - \tilde{\mu}_*(r) r^{1/2} i)( \mu + \tilde{\mu}_*(r) r^{1/2} i) +  \mathcal{O}( r^{3/2} )\right) \sinh(\mu X) \\
&+\frac{2 M^c}{M} \mu^2 ( q(X_0)\sinh(\mu X_0) + q(X_1) \sinh(\mu X_1) ) \cosh(\mu X) + \mathcal{O}( r^2 ) 
\end{aligned}
\end{equation}
The lengths $X$, $X_0$, and $X_1$ depend on $s_1$ and $r$, but we have suppressed that dependence for now for notational convenience. 

\subsection{Parameterization and first rescaling}

We will characterize the system using two natural parameters: the difference $h$ between $\mu$ and $\tilde{\mu}_*(r) r^{1/2} i$, and the difference $\Delta s_1$ between the parameter $s_1$ and $s_1^*(r)$. We will only consider the upper half of the complex plane; what happens in the lower half is the same by Hamiltonian symmetry. For $s_1 \in I_s(r)$, let
\begin{align*}
h &= \mu - \tilde{\mu}_*(r) r^{1/2} i \\
\Delta s_1 &= s_1 - s_1^*(r)
\end{align*}
where $h \in \C$ and $\Delta s_1 s \in \R$. 

In order to expand the $\sinh(\mu X)$ and $\cosh(\mu X)$ terms, we use \cref{Xsub}, we write $\mu X$ as 
\begin{align*}
\mu X &= \mu X(r, m_0, s^*(r) + \Delta s_1) \\
&= \left( X^*(r) + \frac{1}{2 \beta_0} \Delta s_1 + \mathcal{O}(r^{1/2}) \right)\left( \tilde{\mu}_*(r) r^{1/2} i + h\right) \\
&= \pi i + h X^*(r) + \frac{1}{2 \beta_0} \Delta s_1 \left( \tilde{\mu}_*(r) r^{1/2} i + h\right) + \mathcal{O}\left( r^{1/2}(r^{1/2} + h) \right)
\end{align*}
Let 
\[
s = \frac{\Delta s_1}{2 \beta_0 X^*(r)}.
\]
Since $\tilde{\mu}_*(r) r^{1/2} = \frac{\pi}{X^*(r)}$, this simplifies to 
\begin{align}\label{muX1}
\mu X &= \pi i + \left( h + s \tilde{\mu}_*(r) r^{1/2} i + h s \right)X^*(r) + \mathcal{O}\left( r^{1/2}(r^{1/2} + h) \right)
\end{align}

Next, we scale out a factor of $r^{1/2}$. Let
\begin{align*}
h &= r^{1/2} \tilde{h} \\
q(X_0^*(r)) &= r^{1/2} \tilde{q}
\end{align*}
Substituting these into \cref{muX1}, we have
\begin{align}\label{muX2}
\mu X &= \pi i + r^{1/2} \left( \tilde{h} + s \tilde{\mu}_*(r)i + \tilde{h} s \right)X^*(r) + \mathcal{O}(\left( r \right)
\end{align}
Using this, we have the Taylor expansions
\begin{align*}
\sinh(\mu X) &= -r^{1/2} \left( \tilde{h} + s \tilde{\mu}_*(r) i + \tilde{h} s \right)X^*(r) + \mathcal{O}\left( r + r^{3/2}|\log r|^3 \right) \\
\cosh(\mu X) &= -1 + \mathcal{O}\left( r |\log r|^2 \right) \\
\end{align*}

Using \cref{qX0sub}, $q(X_0)$ becomes
\[
q(X_0) = r^{1/2}\tilde{q} + \mathcal{O}(r)
\]
We also want to scale $r^{1/2}$ out from $\sinh(\mu X_j)$ terms. From \cref{qX1bound}, $q(X_1) = \mathcal{O}(r)$. Expanding the $\sinh(\mu X_j)$ terms in a Taylor series about 0, which we can do since $X_j < X$, we get
\begin{align*}
\sinh(\mu X_j) &= \mu X_j + \mathcal{O}(\mu X_j)^3 \\
&= r^{1/2}(\tilde{\mu}_*(r)i + \tilde{h})X_j + \mathcal{O}(r^{3/2} (\tilde{\mu}_*(r)i + \tilde{h})^3 X_j^3)
\end{align*}
Since $X_j = \mathcal{O}(|\log r|)$,
\[
q(X_0) \sinh(\mu X_0) + q(X_1) \sinh(\mu X_1)
= \tilde{q}(\tilde{h} + \tilde{\mu}_*(r)i )r X_0 + \mathcal{O}(r^2 |\log r|^3)
\]
Using \cref{X0sub}, this becomes
\[
q(X_0) \sinh(\mu X_0) + q(X_1) \sinh(\mu X_1)
= \tilde{q}(\tilde{h} + \tilde{\mu}_*(r)i )r X_0^*(r) + \mathcal{O}(r^{3/2} + r^2 |\log r|^3)
\]

Substituting all of these into \cref{KreinB2} and dividing by $-1$ and $r^{3/2}$, we obtain the equation
\begin{equation*}
\begin{aligned}
0 &= \left( \tilde{h} ( \tilde{h} + 2 \tilde{\mu}_*(r) i) +  \mathcal{O}( r^{1/2} )\right) \left( (\tilde{h} + s \tilde{\mu}_*(r) i + \tilde{h} s)X^*(r) + \mathcal{O}\left( r^{1/2} + r|\log r|^3 \right)  \right) \\
&+\frac{2 M^c\tilde{q}}{M} ( \tilde{h} + \tilde{\mu}_*(r) i)^2 \left( (\tilde{h} + \tilde{\mu}_*(r)i )r^{1/2} X_0^*(r) + \mathcal{O}(r + r^{3/2} |\log r|^3 ) \right) \left( 1 + \mathcal{O}\left( r |\log r|^2 \right) \right) \\
&+ \mathcal{O}( r^{1/2} ).
\end{aligned}
\end{equation*}
Simplifying the remainder terms, this becomes
\begin{equation*}\label{KreinB3}
\begin{aligned}
0 &= \left( \tilde{h} ( \tilde{h} + 2 \tilde{\mu}_*(r) i) + \mathcal{O}( r^{1/2} )\right) (\tilde{h} + s \tilde{\mu}_*(r) i + \tilde{h} s)X^*(r) \\
&+\frac{2 M^c\tilde{q}}{M} ( \tilde{h} + \tilde{\mu}_*(r) i)^2 (\tilde{h} + \tilde{\mu}_*(r)i )r^{1/2} X_0^*(r) +  \mathcal{O}\left( r^{1/2} + r |\log r|^3 \right).
\end{aligned}
\end{equation*}

\subsection{Second rescaling}

At this point, we are most of the way there, except for the $r^{1/2}X_0^*(r)$ term on the second line. To figure out an appropriate scaling ansatz to eliminate this term, suppose that $s$ and $\tilde{h}$ are smaller than $\tilde{\mu}_*(r)$. Eliminating all terms we suspect are higher order and simplifying, we obtain an equation of the form
\begin{equation*}
\begin{aligned}
\tilde{h} (\tilde{h} + s \tilde{\mu}_*(r) i) X^*(r) + C r^{1/2} X_0^*(r) \tilde{\mu}_*(r)^2 = 0.
\end{aligned}
\end{equation*} 
Since this is quadratic in $\tilde{h}$, it suggests that $\tilde{h} = C r^{1/4}(X_0^*(r)/X^*(r))^{1/2}$. Let
\begin{align*}
\tilde{h} &= r^{1/4}\left(\frac{X_0^*(r)}{X^*(r)}\right)^{1/2} h_0 \\
s \tilde{\mu}_*(r) &= 2 r^{1/4}\left(\frac{X_0^*(r)}{X^*(r)}\right)^{1/2} s_0
\end{align*}
where the factor of $2$ in $s \tilde{\mu}_*(r)$ is for convenience later. Substituting these into \cref{KreinB3} and simplifying the remainder terms, we obtain the equation
\begin{align*}
0 &= \left( 2 r^{1/4} h_0 \left(\frac{X_0^*(r)}{X^*(r)}\right)^{1/2} \tilde{\mu}_*(r) i  + \mathcal{O}( r^{1/2} )\right) r^{1/4}\left(\frac{X_0^*(r)}{X^*(r)}\right)^{1/2} \left(2 s_0 i + h_0 \right)X^*(r)  \\
&+\frac{2 M^c \tilde{q} }{M} \left(\tilde{\mu}_*(r) i\right)^3 r^{1/2} X_0^*(r) + \mathcal{O}(r^{1/2} + r^{3/4}|\log r| + r |\log r|^3).
\end{align*}
Rearranging the top line, this becomes
\begin{align*}
0 &= \left( 2 r^{1/4} h_0 X_0^*(r)^{1/2} \tilde{\mu}_*(r) i  + \mathcal{O}( r^{1/2} |\log r| )\right) r^{1/4} \left(2 s_0 i + h_0 \right) \\
&+\frac{2 M^c \tilde{q} }{M} \left(\tilde{\mu}_*(r) i\right)^3 r^{1/2} X_0^*(r) + \mathcal{O}(r^{1/2} + r^{3/4}|\log r| + r |\log r|^3).
\end{align*}
Finally, divide by $r^{1/2}X_0^*(r)$ and $2 \mu_*(r) i$to get
\begin{align*}
0 &= \left( h_0 + \mathcal{O}( r^{1/4} )\right) \left(2 s_0 i + h_0 \right) +\frac{M^c \tilde{q} }{M} \left(\tilde{\mu}_*(r) i\right)^2 + \mathcal{O}\left( \frac{1}{|\log r|} \right).
\end{align*}
This simplifies to the equation $G(h_0, s_0, r) = 0$, where $G: \C \times \R \times \mathcal{R} \rightarrow \C$ is defined by
\begin{equation}\label{BsimpleG1}
\begin{aligned}
G(h_0, s_0, r) &= h_0^2 + 2 i s_0 h_0 - \tilde{R}(r) + \mathcal{O}\left( \frac{1}{|\log r|}\right),
\end{aligned}
\end{equation}
and
\[
\tilde{R}(r) = \frac{M^c \tilde{q} }{M} \tilde{\mu}_*(r)^2.
\]

\subsection{Krein bubble}

To leading order, equation \cref{BsimpleG1} is a quadratic in $h_0$. When $r = 0$, $G(h_0, s_0, 0) = 0$ has solution
\begin{equation}\label{Bquadsol}
h_0(s_0) = -s_0 i \pm \sqrt{ \tilde{R}(0) - s_0^2 }
\end{equation}
Assume $\tilde{R}(0) > 0$. Then for $|s_0| \leq \sqrt{\tilde{R}(0)}$, $h_0(s_0)$ describes a circle of radius $\sqrt{\tilde{R}(0)}$ in the complex plane centered at the origin. For $|s_0| \geq \sqrt{\tilde{R}(0)}$, $h_0(s_0)$ is on the imaginary axis. Thus for $r = 0$, this is the Krein bubble!

We will now show that this persists for small $r$. To do that, we will use the implicit function theorem to solve for $h_0$ in terms of $s_0$ for small $r$. Computing the derivative with respect to $h_0$ and noting that all the remainder terms vanish at 0,
\begin{align*}
\partial_{h_0} G(h_0, s_0, 0) 
&= 2 ( h_0 + s_0 i)
\end{align*}
Plugging in $h_0(s_0)$ from \cref{Bquadsol},
\begin{align*}
\partial_{h_0} G(h_0(s_0), s_0, 0) 
&= \pm \sqrt{ \tilde{R}(0) - s_0^2 }
\end{align*}
This is nonzero as long as $s_0 \neq \pm \sqrt{\tilde{R}}$, at which point there is a bifurcation. We will first handle what happens away from the bifurcation, and then we will deal with the bifurcation point.

Choose any $\epsilon > 0$. Define the sets
\begin{align*}
S_\epsilon^{\text{ext}} &= \left[-2 \sqrt{\tilde{R}(0)} -\sqrt{\tilde{R}(0)} - \epsilon\right] \cup \left[\sqrt{\tilde{R}(0)} + \epsilon, 2\sqrt{\tilde{R}(0)}\right] \\
S_\epsilon^{\text{int}} &= 
\left[-\sqrt{\tilde{R}(0)} + \epsilon, \sqrt{\tilde{R}(0)} - \epsilon\right] \\
S_\epsilon &= S_\epsilon^{\text{ext}} \cup S_\epsilon^{\text{int}}
\end{align*}
On the set $S_\epsilon$, $\partial_{h_0} G(s_0, h_0(s_0), 0)$ is bounded away from 0, with bound dependent on $\epsilon$. Using the uniform contraction mapping principle, there exists $r_3 \leq r_2$ (dependent on $\epsilon$) such that for $s_0 \in S_\epsilon$ and $r \leq r_3$, we can solve for $h_0$ in terms of $s_0$ and $r$. Specifically, there exist smooth functions $h_0^\pm: S_\epsilon \times \mathcal{R} \rightarrow \C$ with
\[
h_0^\pm(s_0, 0) = -s_0 i \pm \sqrt{ \tilde{R}(0) - s_0^2 }
\]
such that for all $s_0 \in S_\epsilon$ and $r \leq r_2$, $G(h_0^\pm(s_0,r),s_0,r) = 0$. Expanding in a Taylor series, for $s_0 \in S_\epsilon$,
\[
h_0^\pm(s_0, r) = -s_0 i \pm \sqrt{ \tilde{R}(0) - s_0^2 } + \mathcal{O}\left( \frac{1}{|\log r|} \right)
\]
Undoing both of our scalings, let
\begin{align*}
h^\pm(r) &= \left(\frac{X_0^*(r)}{X}\right)^{1/2} r^{3/4} h_0^\pm(r) \\
s &= \left(\frac{X_0^*(r)}{X}\right)^{1/2} s_0 \\
\end{align*}

\subsection{Bifurcation points}

All that remains is to show what happens at the bifurcation points $s_0 = \pm \sqrt{\tilde{R}}$ for small $r$. We will consider the bifurcation point at $s_0 = \sqrt{\tilde{R}}$. The other one is similar. When $r = 0$ and $s_0 = \sqrt{\tilde{R}}$, $h_0 = -\sqrt{\tilde{R}}i$ is a double root of \cref{BsimpleG1}, i.e. both $G(-\sqrt{\tilde{R}}i, \sqrt{\tilde{R}}, 0) = 0$ and $\partial_{h_0} G(-\sqrt{\tilde{R}}i, \sqrt{\tilde{R}}, 0) = 0$. Define $K: \C \times \R \times \mathcal{R} \rightarrow \C^2$ by
\begin{equation}
K(h_0, s_0, r) = 
\begin{pmatrix}G(h_0, s_0, r) \\ \partial_{h_0}G(h_0, s_0, r) \end{pmatrix} 
= \begin{pmatrix}
h_0^2 + 2 i s_0 h_0 - \tilde{R} \\
2(h_0 + s_0 i) 
\end{pmatrix}
+ \mathcal{O}\left( \frac{1}{|\log r|} \right)
\end{equation}
When $r = 0$, $K\left(-\sqrt{\tilde{R}}i, \sqrt{\tilde{R}}, 0\right) = 0$. The Jacobian with respect to $(h_0, s_0)$ is
\[
D_{(z, \epsilon)}K(z, \epsilon, r) = 
\begin{pmatrix}
2 h_0 + 2 i s_0 & 2 i s_0  \\
2 & 2 i
\end{pmatrix}
+ \mathcal{O}\left( \frac{1}{|\log r|} \right)
\]
At $(h_0, s_0, r) = \left( -\sqrt{\tilde{R}}i, \sqrt{\tilde{R}},0\right)$, 
\[
D_{(h_0, s_0)}K\left( -\sqrt{\tilde{R}}i, \sqrt{\tilde{R}},0\right) = 
2 \begin{pmatrix}
0 & \sqrt{\tilde{R}}i \\
1 & i
\end{pmatrix}
\]
which is nonsingular since the columns are linearly independent. Using the implicit function theorem, we can solve for $(h_0, s_0)$ near $(-\sqrt{\tilde{R}}i, \sqrt{\tilde{R}})$ in terms of $r$ for sufficiently small $r$. Specifically, there exists $r_2 \leq r_1$ and a unique smooth function $(h_0^-, s_0^-)(r)$ with $(h_0^-, s_0^-)(0) = (-\sqrt{\tilde{R}}i, \sqrt{\tilde{R}})$ such that for all $r \leq r_2$, $K(h_0^-(r), s_0^-(r), r) = 0$. For $r \leq r_2$ and $s_0 = s_0^-(r)$, $h_0^-(r)$ is a double root of $G(h_0, s_0, r)$. Expanding in a Taylor series, we have
\begin{align*}
h_0^-(r) &= -\sqrt{\tilde{R}}i + \mathcal{O}\left( \frac{1}{|\log r|} \right) \\
s_0^-(r) &= \sqrt{\tilde{R}} + \mathcal{O}\left( \frac{1}{|\log r|} \right) \\
\end{align*}

Similarly, we can find $h_0^+(r)$ and $s_0^+(r)$ with
\begin{align*}
h_0^+(r) &= \sqrt{\tilde{R}}i + \mathcal{O}\left( \frac{1}{|\log r|} \right) \\
s_0^+(r) &= -\sqrt{\tilde{R}} + \mathcal{O}\left( \frac{1}{|\log r|} \right) \\
\end{align*}
such that for $r \leq r_2$ and $s_0 = s_0^+(r)$, $h_0^+(r)$ is a double root of $G(h_0, s_0, r)$.

\subsection{Undoing the scalings}

Undoing both scalings, let 
\begin{align*}
h^\pm(r) &= \frac{X_0^{1/2}}{X^{1/2}}r^{3/4} h_0^\pm(r) \\
s^\pm(r) &= \frac{X_0^{1/2}}{X^{1/2}}r^{3/4} h_0^\pm(r) \\
\end{align*}
Then for $r \leq r_2$, when 
\[
s = s^\pm(r) = \mp \frac{X_0^{1/2}}{X^{1/2}}r^{3/4} \sqrt{\tilde{R}} + \mathcal{O}\left( \frac{1}{|\log r|} \right),
\]
$S(\mu)$ has double zero at
\[
\mu^\pm(r) = \left( \mu_*(r) \pm \frac{X_0^{1/2}}{X^{1/2}}r^{3/4} \sqrt{\tilde{R}} \right)i + \mathcal{O}\left( \frac{1}{|\log r|} \right)
\]
By Lemma \ref{lemma:Hamsymmmu}, Hamiltonian symmetry applies to $\mu$ as well, thus the only way this is possible is if $\mu^\pm(r)$ is on the imaginary axis. 


\iffulldocument\else
	\bibliographystyle{amsalpha}
	\bibliography{thesis.bib}
\fi

\end{document}